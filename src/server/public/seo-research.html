<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SEO Research Tool</title>
    <style>
      body { 
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial, sans-serif; 
        margin: 0; 
        padding: 0; 
        background: #0b1220; 
        color: #e5e7eb; 
      }
      .container { 
        max-width: 1200px; 
        margin: 0 auto; 
        padding: 24px; 
      }
      h1 { 
        margin: 0 0 16px; 
        font-size: 24px; 
        color: #93c5fd; 
        text-align: center;
      }
      .subtitle {
        text-align: center;
        color: #9ca3af;
        margin-bottom: 32px;
      }
      .research-form {
        background: #0f172a; 
        border: 1px solid #1f2937; 
        border-radius: 12px; 
        padding: 24px; 
        margin-bottom: 24px;
      }
      .form-group {
        margin-bottom: 20px;
      }
      label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        color: #d1d5db;
      }
      input, textarea, select {
        width: 100%;
        padding: 12px;
        border-radius: 8px;
        border: 1px solid #334155;
        background: #111827;
        color: #e5e7eb;
        font-size: 14px;
        box-sizing: border-box;
      }
      textarea {
        resize: vertical;
        min-height: 100px;
      }
      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
      }
      button {
        padding: 12px 24px;
        border-radius: 8px;
        border: 1px solid #3b82f6;
        background: #1d4ed8;
        color: white;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        transition: all 0.2s;
      }
      button:hover:not(:disabled) {
        background: #2563eb;
      }
      button:disabled {
        opacity: 0.6;
        cursor: not-allowed;
      }
      .results-section {
        background: #0f172a;
        border: 1px solid #1f2937;
        border-radius: 12px;
        padding: 24px;
        margin-top: 24px;
      }
      .results-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
        padding-bottom: 12px;
        border-bottom: 1px solid #1f2937;
      }
      .status-indicator {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 6px 12px;
        border-radius: 6px;
        font-size: 12px;
        font-weight: 500;
      }
      .status-processing {
        background: #1e3a8a;
        color: #93c5fd;
      }
      .status-complete {
        background: #166534;
        color: #86efac;
      }
      .status-error {
        background: #991b1b;
        color: #fca5a5;
      }
      .research-output {
        background: #111827;
        border: 1px solid #374151;
        border-radius: 8px;
        padding: 20px;
        white-space: pre-wrap;
        font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
        font-size: 13px;
        line-height: 1.5;
        max-height: 600px;
        overflow-y: auto;
      }
      .quick-researches {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 12px;
        margin-bottom: 24px;
      }
      .quick-research {
        padding: 16px;
        background: #111827;
        border: 1px solid #374151;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s;
        text-align: center;
      }
      .quick-research:hover {
        background: #1f2937;
        border-color: #4b5563;
      }
      .quick-research h3 {
        margin: 0 0 8px;
        font-size: 14px;
        color: #e5e7eb;
      }
      .quick-research p {
        margin: 0;
        font-size: 12px;
        color: #9ca3af;
      }
      .copy-btn {
        margin-top: 12px;
        padding: 8px 16px;
        background: #374151;
        border: 1px solid #4b5563;
        color: #e5e7eb;
        border-radius: 6px;
        cursor: pointer;
        font-size: 12px;
      }
      .copy-btn:hover {
        background: #4b5563;
      }
      .copy-btn.copied {
        background: #166534;
        border-color: #16a34a;
        color: #86efac;
      }
      @media (max-width: 768px) {
        .form-row {
          grid-template-columns: 1fr;
        }
        .quick-researches {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>üîç SEO Research Tool</h1>
      <p class="subtitle">Discover high-value keywords and optimize your content strategy</p>
      <div style="text-align: center; margin-bottom: 20px;">
        <a href="/" style="color: #93c5fd; text-decoration: none; padding: 8px 16px; border: 1px solid #3b82f6; border-radius: 6px; background: #1d4ed8; margin-right: 12px;">
          üè† Homepage
        </a>
        <a href="/index.html" style="color: #93c5fd; text-decoration: none; padding: 8px 16px; border: 1px solid #3b82f6; border-radius: 6px; background: #1d4ed8; margin-right: 12px;">
          üå§Ô∏è Weather Chat
        </a>
        <a href="/competitive-analysis.html" style="color: #93c5fd; text-decoration: none; padding: 8px 16px; border: 1px solid #3b82f6; border-radius: 6px; background: #1d4ed8; margin-right: 12px;">
          üîç Competitive Analysis
        </a>
        <a href="/content-writer.html" style="color: #93c5fd; text-decoration: none; padding: 8px 16px; border: 1px solid #3b82f6; border-radius: 6px; background: #1d4ed8; margin-right: 12px;">
          ‚úçÔ∏è Content Writer
        </a>
        <a href="/image-search.html" style="color: #93c5fd; text-decoration: none; padding: 8px 16px; border: 1px solid #3b82f6; border-radius: 6px; background: #1d4ed8;">
          üñºÔ∏è Image Search
        </a>
      </div>

      <div class="quick-researches">
        <div class="quick-research" onclick="fillQuickResearch('primary-keywords')">
          <h3>üéØ Primary Keywords</h3>
          <p>Find main target keywords</p>
        </div>
        <div class="quick-research" onclick="fillQuickResearch('long-tail')">
          <h3>üìà Long-tail Keywords</h3>
          <p>Discover specific phrases</p>
        </div>
        <div class="quick-research" onclick="fillQuickResearch('competitor-gaps')">
          <h3>üîç Competitor Gaps</h3>
          <p>Find missed opportunities</p>
        </div>
        <div class="quick-research" onclick="fillQuickResearch('intent-analysis')">
          <h3>üß† Intent Analysis</h3>
          <p>Classify search intent</p>
        </div>
        <div class="quick-research" onclick="fillQuickResearch('content-ideas')">
          <h3>üí° Content Ideas</h3>
          <p>Generate topic suggestions</p>
        </div>
        <div class="quick-research" onclick="fillQuickResearch('technical-seo')">
          <h3>‚öôÔ∏è Technical SEO</h3>
          <p>Optimization recommendations</p>
        </div>
      </div>

      <div class="research-form">
        <div class="form-group">
          <label for="research-type">Research Type</label>
          <select id="research-type">
            <option value="keyword-research">Keyword Research</option>
            <option value="competitor-analysis">Competitor Analysis</option>
            <option value="content-strategy">Content Strategy</option>
            <option value="technical-audit">Technical SEO Audit</option>
            <option value="local-seo">Local SEO</option>
            <option value="ecommerce-seo">E-commerce SEO</option>
          </select>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="primary-topic">Primary Topic / Industry</label>
            <input type="text" id="primary-topic" placeholder="e.g., 'AI video generation', 'project management software', 'e-commerce platform'" />
          </div>
          <div class="form-group">
            <label for="target-audience">Target Audience</label>
            <input type="text" id="target-audience" placeholder="e.g., 'SaaS founders', 'small business owners', 'marketing managers'" />
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="business-stage">Business Stage</label>
            <select id="business-stage">
              <option value="startup">Startup (New Site)</option>
              <option value="growing">Growing (Established Site)</option>
              <option value="enterprise">Enterprise (Large Site)</option>
            </select>
          </div>
          <div class="form-group">
            <label for="competition-level">Competition Level</label>
            <select id="competition-level">
              <option value="low">Low Competition</option>
              <option value="medium">Medium Competition</option>
              <option value="high">High Competition</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="target-keywords">Target Keywords (Optional)</label>
          <input type="text" id="target-keywords" placeholder="Enter specific keywords you want to research, separated by commas" />
        </div>

        <div class="form-group">
          <label for="competitors">Competitors (Optional)</label>
          <input type="text" id="competitors" placeholder="List competitor websites or brands" />
        </div>

        <div class="form-group">
          <label for="research-goals">Research Goals</label>
          <textarea id="research-goals" placeholder="Describe your SEO goals, target metrics, and any specific insights you're looking for..."></textarea>
        </div>

        <button id="research-btn" onclick="startResearch()">üöÄ Start SEO Research</button>
      </div>

      <div class="results-section" id="results-section" style="display: none;">
        <div class="results-header">
          <h2>Research Results</h2>
          <div id="status-indicator" class="status-indicator status-processing">
            <span>‚è≥</span>
            <span>Researching...</span>
          </div>
        </div>
        <div id="research-output" class="research-output"></div>
        <button id="copy-btn" class="copy-btn" onclick="copyResults()" style="display: none;">üìã Copy Results</button>
      </div>
    </div>

    <script>
      const quickResearches = {
        'primary-keywords': {
          researchType: 'keyword-research',
          primaryTopic: 'AI video generation software',
          targetAudience: 'content creators and marketers',
          researchGoals: 'Find primary keywords with commercial intent for AI video generation tools'
        },
        'long-tail': {
          researchType: 'keyword-research',
          primaryTopic: 'project management solutions',
          targetAudience: 'small business owners',
          researchGoals: 'Discover long-tail keywords with lower competition for project management content'
        },
        'competitor-gaps': {
          researchType: 'competitor-analysis',
          primaryTopic: 'SaaS productivity tools',
          targetAudience: 'business professionals',
          researchGoals: 'Identify keyword gaps and opportunities competitors are missing'
        },
        'intent-analysis': {
          researchType: 'keyword-research',
          primaryTopic: 'marketing automation',
          targetAudience: 'marketing teams',
          researchGoals: 'Analyze search intent and classify keywords by buyer journey stage'
        },
        'content-ideas': {
          researchType: 'content-strategy',
          primaryTopic: 'e-commerce platform',
          targetAudience: 'online retailers',
          researchGoals: 'Generate content ideas based on keyword research and user intent'
        },
        'technical-seo': {
          researchType: 'technical-audit',
          primaryTopic: 'website optimization',
          targetAudience: 'web developers and SEO specialists',
          researchGoals: 'Identify technical SEO improvements and optimization opportunities'
        }
      };

      function fillQuickResearch(researchType) {
        const research = quickResearches[researchType];
        if (research) {
          document.getElementById('research-type').value = research.researchType;
          document.getElementById('primary-topic').value = research.primaryTopic;
          document.getElementById('target-audience').value = research.targetAudience;
          document.getElementById('research-goals').value = research.researchGoals;
        }
      }

      async function startResearch() {
        const researchType = document.getElementById('research-type').value;
        const primaryTopic = document.getElementById('primary-topic').value.trim();
        const targetAudience = document.getElementById('target-audience').value.trim();
        const businessStage = document.getElementById('business-stage').value;
        const competitionLevel = document.getElementById('competition-level').value;
        const targetKeywords = document.getElementById('target-keywords').value.trim();
        const competitors = document.getElementById('competitors').value.trim();
        const researchGoals = document.getElementById('research-goals').value.trim();

        if (!primaryTopic) {
          alert('Please enter a primary topic or industry');
          return;
        }

        const researchBtn = document.getElementById('research-btn');
        const resultsSection = document.getElementById('results-section');
        const statusIndicator = document.getElementById('status-indicator');
        const researchOutput = document.getElementById('research-output');
        const copyBtn = document.getElementById('copy-btn');

        // Reset UI
        researchBtn.disabled = true;
        resultsSection.style.display = 'block';
        statusIndicator.className = 'status-indicator status-processing';
        statusIndicator.innerHTML = '<span>‚è≥</span><span>Researching...</span>';
        researchOutput.textContent = '';
        copyBtn.style.display = 'none';

        // Build the research prompt
        let prompt = `Perform ${researchType} for "${primaryTopic}"\n\n`;
        
        if (targetAudience) prompt += `Target Audience: ${targetAudience}\n`;
        prompt += `Business Stage: ${businessStage}\n`;
        prompt += `Competition Level: ${competitionLevel}\n\n`;
        
        if (targetKeywords) {
          prompt += `Target Keywords: ${targetKeywords}\n\n`;
        }
        
        if (competitors) {
          prompt += `Competitors: ${competitors}\n\n`;
        }
        
        if (researchGoals) {
          prompt += `Research Goals: ${researchGoals}\n\n`;
        }

        prompt += `Please provide comprehensive SEO research including:
1. Primary keyword analysis with search intent classification
2. Related keyword opportunities with volume estimates
3. Long-tail keyword suggestions for content creation
4. Competitive analysis and difficulty assessment
5. Content strategy recommendations based on keyword insights
6. Technical SEO recommendations if applicable

Focus on actionable insights that can drive organic traffic and conversions.`;

        try {
          const response = await fetch('/api/seo-research', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              messages: [
                {
                  role: 'user',
                  content: prompt
                }
              ]
            })
          });

          if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }

          const reader = response.body.getReader();
          const decoder = new TextDecoder();
          let fullResponse = '';

          while (true) {
            const { value, done } = await reader.read();
            if (done) break;

            const chunk = decoder.decode(value, { stream: true });
            const lines = chunk.split('\n').filter(line => line.trim());

            for (const line of lines) {
              if (line.startsWith('data: ')) {
                try {
                  const data = JSON.parse(line.slice(6));
                  if (data.type === 'token') {
                    fullResponse += data.value;
                    researchOutput.textContent = fullResponse;
                    researchOutput.scrollTop = researchOutput.scrollHeight;
                  } else if (data.type === 'error') {
                    throw new Error(data.message);
                  }
                } catch (parseError) {
                  console.warn('Failed to parse SSE data:', parseError);
                }
              }
            }
          }

          // Update status to complete
          statusIndicator.className = 'status-indicator status-complete';
          statusIndicator.innerHTML = '<span>‚úÖ</span><span>Research Complete</span>';
          copyBtn.style.display = 'block';

        } catch (error) {
          console.error('SEO research failed:', error);
          statusIndicator.className = 'status-indicator status-error';
          statusIndicator.innerHTML = '<span>‚ùå</span><span>Research Failed</span>';
          researchOutput.textContent = `Error: ${error.message}`;
        } finally {
          researchBtn.disabled = false;
        }
      }

      function copyResults() {
        const researchOutput = document.getElementById('research-output');
        const copyBtn = document.getElementById('copy-btn');
        
        navigator.clipboard.writeText(researchOutput.textContent).then(() => {
          copyBtn.textContent = '‚úÖ Copied!';
          copyBtn.className = 'copy-btn copied';
          setTimeout(() => {
            copyBtn.textContent = 'üìã Copy Results';
            copyBtn.className = 'copy-btn';
          }, 2000);
        }).catch(err => {
          console.error('Failed to copy results:', err);
          alert('Failed to copy results to clipboard');
        });
      }

      // Allow Ctrl+Enter to submit
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' && e.ctrlKey) {
          startResearch();
        }
      });
    </script>
  </body>
</html>
